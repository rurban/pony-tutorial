<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Object literals - Pony Tutorial</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/highlight.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Object literals";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../js/highlight.pack.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Pony Tutorial</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Getting started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../..">Welcome!</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/what-you-need-to-start/">What you need to start</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/installation/">Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/helloworld/">Helloworld</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/how-it-works/">How it works</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/whitespace/">Whitespace</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Types</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/static-vs-dynamic/">Static vs dynamic</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/classes/">Classes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/primitives/">Primitives</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/actors/">Actors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/traits-and-interfaces/">Traits and interfaces</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/type-aliases/">Type aliases</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../types/type-expressions/">Type expressions</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Capabilities</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/introduction/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/guarantees/">Guarantees</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/aliasing/">Aliasing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/combining-capabilities/">Combining capabilities</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/passing-and-sharing/">Passing and sharing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/capability-subtyping/">Capability subtyping</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../capabilities/arrow-types/">Arrow types</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Expressions</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../variables/">Variables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../infix-ops/">Infix ops</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../control-structures/">Control structures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../methods/">Methods</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../exceptions/">Exceptions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sugar/">Sugar</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Object literals</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#whats-this-look-like-then">What's this look like, then?</a></li>
                
            
                <li class="toctree-l3"><a href="#lambdas">Lambdas</a></li>
                
            
                <li class="toctree-l3"><a href="#actor-literals">Actor literals</a></li>
                
            
                <li class="toctree-l3"><a href="#primitive-literals">Primitive literals</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../partial-application/">Partial application</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Actors</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../actors/behaviours/">Behaviours</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../actors/capabilities/">Capabilities</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../actors/recover-and-consume/">Recover and consume</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../actors/arrow-types/">Arrow types</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../packages/package-system/">Package system</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../composition-inheritance/code-sharing/">Code sharing</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Generics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../generics/polymorphic-types/">Polymorphic types</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../generics/polymorphic-methods/">Polymorphic methods</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Pattern Matching</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../pattern-matching/match/">Match</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../pattern-matching/as/">As</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../platform/platform/">Platform</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../editor-plugins/plugins/">Editor support</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../compiler-clargs/clargs/">Compiler args</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../patterns/patterns/">Patterns</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Memory management</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../garbage-collection/memory-allocation/">Memory allocation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../garbage-collection/garbage-collection/">Garbage collection</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>C FFI</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../c-ffi/calling-c/">Calling C</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../c-ffi/linking-c/">Linking to C Libraries</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../c-ffi/c-abi/">C abi</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../examples/examples/">Examples</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Pony Tutorial</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Expressions &raquo;</li>
        
      
    
    <li>Object literals</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Sometimes it's really convenient to be able to write a whole object inline. In Pony, this is called an object literal, and it does pretty much exactly what an object literal in JavaScript does: it creates an object that you can use immediately.</p>
<p>But Pony is statically typed, so an object literal also creates an anonymous type that the object literal fulfills. This is similar to anonymous classes in Java and C#. In Pony, an anonymous type can provide any number of traits and interfaces.</p>
<h1 id="whats-this-look-like-then">What's this look like, then?</h1>
<p>It basically looks like any other type definition, but with some small differences. Here's a simple one:</p>
<pre><code class="pony">object
  fun apply(): String =&gt; &quot;hi&quot;
end
</code></pre>

<p>Ok, that's pretty trivial. Let's extend it so that it explicitly provides an interface, so that the compiler will make sure the anonymous type fulfills that interface. You can use the same notation to provide traits as well.</p>
<pre><code class="pony">object is Hashable
  fun apply(): String =&gt; &quot;hi&quot;
  fun hash(): U64 =&gt; this().hash()
end
</code></pre>

<p>What we can't do is specify constructors in an object literal, because literal <em>is</em> the constructor. So how do we assign to fields? Well, we just assign to them. For example:</p>
<pre><code class="pony">class Foo
  fun foo(str: String): Hashable =&gt;
    object is Hashable
      let s: String = str
      fun apply(): String =&gt; s
      fun hash(): U64 =&gt; s.hash()
    end
</code></pre>

<p>When we assign to a field in the constructor, we are <em>capturing</em> from the lexical scope the object literal is in. Pretty fun stuff! It lets us have arbitrarily complex <strong>closures</strong> that can even have multiple entry points (i.e. functions you can call on a closure).</p>
<p>An object literal is always returned as a <code>ref</code>, like a default construtor on a class. To get another capability (<code>iso</code>, <code>val</code>, etc.), you can wrap the object literal in a <code>recover</code> expression.</p>
<h1 id="lambdas">Lambdas</h1>
<p>Arbitrarily complex closures are nice, but sometimes we just want a simple closure. In Pony, you can use the <code>lambda</code> keyword for that.</p>
<pre><code class="pony">lambda(s: String): String =&gt; &quot;lambda: &quot; + s end
</code></pre>

<p>This produces the same code as:</p>
<pre><code class="pony">object
  fun apply(s: String): String =&gt; &quot;lambda: &quot; + s
end
</code></pre>

<h1 id="actor-literals">Actor literals</h1>
<p>Normally, an object literal is an instance of an anonymous class. To make it an instance of an anonymous actor, just include one or more behaviours in the object literal definition.</p>
<pre><code class="pony">object
  let stream: Stream = env.out
  be apply() =&gt; stream.print(&quot;hi&quot;)
end
</code></pre>

<p>An actor literal is always returned as a <code>tag</code>.</p>
<h1 id="primitive-literals">Primitive literals</h1>
<p>When an anonymous type has no fields and no behaviours (like, for example, an object literal declared with the <code>lambda</code> keyword), the compiler generates it as an anonymous primitive. This means no memory allocation is needed to generate an instance of that type.</p>
<p>In other words, a lambda in Pony has no memory allocation overhead. Nice.</p>
<p>A primitive literal is always returned as a <code>val</code>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../partial-application/" class="btn btn-neutral float-right" title="Partial application"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../sugar/" class="btn btn-neutral" title="Sugar"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../sugar/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../partial-application/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
